<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terminal do Professor</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --success-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --dark-bg: #0f0f23;
            --card-bg: rgba(255, 255, 255, 0.95);
            --glass-bg: rgba(255, 255, 255, 0.1);
            --text-primary: #2d3748;
            --text-secondary: #718096;
            --border-color: rgba(255, 255, 255, 0.2);
        }
        * { font-family: 'Inter', sans-serif; }
        body {
            background: var(--dark-bg);
            background-image: 
                radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(120, 219, 255, 0.2) 0%, transparent 50%);
            min-height: 100vh;
            overflow-x: hidden;
        }
        .glass-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        .glass-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }
        .btn-gradient {
            background: var(--primary-gradient);
            border: none;
            border-radius: 15px;
            color: white;
            font-weight: 600;
            padding: 12px 30px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .btn-gradient::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        .btn-gradient:hover::before { left: 100%; }
        .btn-gradient:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }
        .list-group-item { background: rgba(255,255,255,0.8); }
        .section-title {
            color: #fff;
            margin-bottom: 30px;
            font-weight: 700;
        }
        @media (max-width: 768px) {
            .container-fluid { padding: 10px; }
            .glass-card { margin: 10px 0; }
        }
    </style>
</head>
<body>
    <div class="container-fluid py-4">
        <h1 class="section-title"><i class="fas fa-chalkboard-teacher me-2"></i>Terminal do Professor</h1>
        <div class="row">
            <!-- Cadastro de Disciplina -->
            <div class="col-lg-3 mb-4">
                <div class="glass-card p-4">
                    <h5 class="mb-3 text-white"><i class="fas fa-book me-2"></i>Nova Disciplina</h5>
                    <form id="formDisciplina">
                        <div class="mb-3">
                            <input type="text" class="form-control" id="disciplinaNome" placeholder="Nome da Disciplina" required>
                        </div>
                        <div class="mb-3">
                            <input type="text" class="form-control" id="disciplinaTurma" placeholder="Turma (ex: 1A, 2B)" required>
                        </div>
                        <button type="submit" class="btn btn-gradient w-100">Cadastrar Disciplina</button>
                    </form>
                    <hr class="my-3">
                    <h6 class="text-white">Disciplinas Cadastradas:</h6>
                    <ul id="listaDisciplinas" class="list-group"></ul>
                </div>
            </div>
            <!-- Cadastro de Aluno -->
            <div class="col-lg-3 mb-4">
                <div class="glass-card p-4">
                    <h5 class="mb-3 text-white"><i class="fas fa-user-plus me-2"></i>Novo Aluno</h5>
                    <div class="mb-3">
                        <button type="button" class="btn btn-outline-primary w-100 mb-2" onclick="document.getElementById('inputImportAlunos').click()">
                            <i class="fas fa-file-import me-2"></i>Importar lista de alunos (.xls)
                        </button>
                        <input type="file" id="inputImportAlunos" accept=".xls,.xlsx" style="display:none" />
                    </div>
                    <form id="formAluno">
                        <div class="mb-3">
                            <input type="text" class="form-control" id="alunoNome" placeholder="Nome do Aluno" required>
                        </div>
                        <div class="mb-3">
                            <input type="text" class="form-control" id="alunoTurma" placeholder="Turma (ex: 1A, 2B)" required>
                        </div>
                        <button type="submit" class="btn btn-gradient w-100">Cadastrar Aluno</button>
                    </form>
                    <hr class="my-3">
                    <h6 class="text-white">Alunos Cadastrados:</h6>
                    <ul id="listaAlunos" class="list-group"></ul>
                </div>
            </div>
            <!-- Cadastro de Atividade -->
            <div class="col-lg-3 mb-4">
                <div class="glass-card p-4">
                    <h5 class="mb-3 text-white"><i class="fas fa-tasks me-2"></i>Nova Atividade</h5>
                    <form id="formAtividade">
                        <div class="mb-3">
                            <input type="text" class="form-control" id="atividadeNome" placeholder="Nome da Atividade" required>
                        </div>
                        <div class="mb-3">
                            <select class="form-select" id="atividadeDisciplina" required>
                                <option value="">Selecione a Disciplina</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <input type="date" class="form-control" id="atividadeData" required>
                        </div>
                        <button type="submit" class="btn btn-gradient w-100">Cadastrar Atividade</button>
                    </form>
                    <hr class="my-3">
                    <h6 class="text-white">Atividades Cadastradas:</h6>
                    <ul id="listaAtividades" class="list-group"></ul>
                </div>
            </div>
            <!-- Lançar Notas -->
            <div class="col-lg-3 mb-4">
                <div class="glass-card p-4">
                    <h5 class="mb-3 text-white"><i class="fas fa-edit me-2"></i>Lançar Nota</h5>
                    <form id="formNota">
                        <div class="mb-3">
                            <select class="form-select" id="selectTurma" required>
                                <option value="">Selecione a Turma</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <select class="form-select" id="selectAluno" required>
                                <option value="">Selecione o Aluno</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <select class="form-select" id="selectDisciplina" required>
                                <option value="">Selecione a Disciplina</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <select class="form-select" id="selectAtividade" required>
                                <option value="">Selecione a Atividade</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <input type="number" class="form-control" id="notaValor" placeholder="Nota" min="0" max="10" step="0.1" required>
                        </div>
                        <button type="submit" class="btn btn-gradient w-100">Lançar Nota</button>
                    </form>
                    <hr class="my-3">
                    <h6 class="text-white">Notas Lançadas:</h6>
                    <ul id="listaNotas" class="list-group"></ul>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
    // Dados em memória (pode ser adaptado para localStorage)
    let disciplinas = [];
    let alunos = [];
    let atividades = [];
    let notas = [];

    // Função para obter todas as turmas cadastradas
    function getTurmas() {
        const turmasDisc = disciplinas.map(d => d.turma);
        const turmasAlu = alunos.map(a => a.turma);
        return [...new Set([...turmasDisc, ...turmasAlu])].filter(Boolean);
    }

    function atualizarListas() {
        // Disciplinas
        const listaDisciplinas = document.getElementById('listaDisciplinas');
        listaDisciplinas.innerHTML = '';
        disciplinas.forEach((d) => {
            const li = document.createElement('li');
            li.className = 'list-group-item';
            li.textContent = `${d.nome} (${d.turma})`;
            listaDisciplinas.appendChild(li);
        });

        // Alunos
        const listaAlunos = document.getElementById('listaAlunos');
        listaAlunos.innerHTML = '';
        alunos.forEach((a) => {
            const li = document.createElement('li');
            li.className = 'list-group-item';
            // Mostra matrícula, número e nome
            li.textContent = `${a.matricula || ''} ${a.numero || ''} ${a.nome} (${a.turma})`;
            listaAlunos.appendChild(li);
        });

        // Atividades
        const listaAtividades = document.getElementById('listaAtividades');
        listaAtividades.innerHTML = '';
        atividades.forEach((atv) => {
            const li = document.createElement('li');
            li.className = 'list-group-item';
            li.textContent = `${atv.nome} (${atv.disciplina}) - ${atv.data}`;
            listaAtividades.appendChild(li);
        });

        // Select de turmas
        const selectTurma = document.getElementById('selectTurma');
        selectTurma.innerHTML = '<option value="">Selecione a Turma</option>';
        getTurmas().forEach(turma => {
            const opt = document.createElement('option');
            opt.value = turma;
            opt.textContent = turma;
            selectTurma.appendChild(opt);
        });

        // Selects para notas (filtrados por turma)
        const turmaSelecionada = selectTurma.value;
        const selectAluno = document.getElementById('selectAluno');
        selectAluno.innerHTML = '<option value="">Selecione o Aluno</option>';
        alunos.filter(a => a.turma === turmaSelecionada).forEach(a => {
            const opt = document.createElement('option');
            opt.value = a.nome;
            opt.textContent = a.nome;
            selectAluno.appendChild(opt);
        });

        const selectDisciplina = document.getElementById('selectDisciplina');
        selectDisciplina.innerHTML = '<option value="">Selecione a Disciplina</option>';
        disciplinas.filter(d => d.turma === turmaSelecionada).forEach(d => {
            const opt = document.createElement('option');
            opt.value = d.nome;
            opt.textContent = d.nome;
            selectDisciplina.appendChild(opt);
        });

        // Select de atividades (filtra por disciplina e turma)
        const disciplinaSelecionada = selectDisciplina.value;
        const selectAtividade = document.getElementById('selectAtividade');
        selectAtividade.innerHTML = '<option value="">Selecione a Atividade</option>';
        atividades.filter(atv => {
            return (!disciplinaSelecionada || atv.disciplina === disciplinaSelecionada) &&
                   (!turmaSelecionada || disciplinas.find(d => d.nome === atv.disciplina && d.turma === turmaSelecionada));
        }).forEach(atv => {
            const opt = document.createElement('option');
            opt.value = atv.nome;
            opt.textContent = `${atv.nome} (${atv.data})`;
            selectAtividade.appendChild(opt);
        });

        // Notas
        const listaNotas = document.getElementById('listaNotas');
        listaNotas.innerHTML = '';
        notas.filter(n => n.turma === turmaSelecionada).forEach((n) => {
            const li = document.createElement('li');
            li.className = 'list-group-item';
            li.textContent = `${n.aluno} - ${n.disciplina} - ${n.atividade}: ${n.nota}`;
            listaNotas.appendChild(li);
        });
    }

    // Cadastro de disciplina
    document.getElementById('formDisciplina').addEventListener('submit', function(e) {
        e.preventDefault();
        const nome = document.getElementById('disciplinaNome').value.trim();
        const turma = document.getElementById('disciplinaTurma').value.trim();
        if (nome && turma && !disciplinas.some(d => d.nome === nome && d.turma === turma)) {
            disciplinas.push({ nome, turma });
            document.getElementById('disciplinaNome').value = '';
            document.getElementById('disciplinaTurma').value = '';
            atualizarListas();
            atualizarAtividadeDisciplina();
        }
    });

    // Cadastro de aluno
    document.getElementById('formAluno').addEventListener('submit', function(e) {
        e.preventDefault();
        const nome = document.getElementById('alunoNome').value.trim();
        const turma = document.getElementById('alunoTurma').value.trim();
        if (nome && turma && !alunos.some(a => a.nome === nome && a.turma === turma)) {
            alunos.push({ nome, turma });
            document.getElementById('alunoNome').value = '';
            document.getElementById('alunoTurma').value = '';
            atualizarListas();
        }
    });

    // Cadastro de atividade
    document.getElementById('formAtividade').addEventListener('submit', function(e) {
        e.preventDefault();
        const nome = document.getElementById('atividadeNome').value.trim();
        const disciplina = document.getElementById('atividadeDisciplina').value;
        const data = document.getElementById('atividadeData').value;
        if (nome && disciplina && data) {
            atividades.push({ nome, disciplina, data });
            document.getElementById('atividadeNome').value = '';
            document.getElementById('atividadeDisciplina').value = '';
            document.getElementById('atividadeData').value = '';
            atualizarListas();
        }
    });

    // Atualiza select de disciplina em atividades
    function atualizarAtividadeDisciplina() {
        const atividadeDisciplina = document.getElementById('atividadeDisciplina');
        atividadeDisciplina.innerHTML = '<option value="">Selecione a Disciplina</option>';
        disciplinas.forEach(d => {
            const opt = document.createElement('option');
            opt.value = d.nome;
            opt.textContent = `${d.nome} (${d.turma})`;
            atividadeDisciplina.appendChild(opt);
        });
    }
    atualizarAtividadeDisciplina();

    // Atualiza selects ao mudar turma ou disciplina
    document.getElementById('selectTurma').addEventListener('change', atualizarListas);
    document.getElementById('selectDisciplina').addEventListener('change', atualizarListas);

    // Lançar nota
    document.getElementById('formNota').addEventListener('submit', function(e) {
        e.preventDefault();
        const turma = document.getElementById('selectTurma').value;
        const aluno = document.getElementById('selectAluno').value;
        const disciplina = document.getElementById('selectDisciplina').value;
        const atividade = document.getElementById('selectAtividade').value;
        const nota = document.getElementById('notaValor').value;
        if (turma && aluno && disciplina && atividade && nota !== '') {
            notas.push({ turma, aluno, disciplina, atividade, nota });
            document.getElementById('notaValor').value = '';
            atualizarListas();
        }
    });

    // Importação de alunos via XLS/XLSX
    document.getElementById('inputImportAlunos').addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = function(e) {
            const data = new Uint8Array(e.target.result);
            const workbook = XLSX.read(data, {type: 'array'});
            const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
            const alunosImportados = XLSX.utils.sheet_to_json(firstSheet, {header: 1});
            alunosImportados.forEach(row => {
                const matricula = row[0];
                const numero = row[1];
                const nome = row[2];
                const turma = row[3] || '';
                if (
                    matricula && numero && nome && turma &&
                    !alunos.some(a => a.matricula === matricula && a.turma === turma) &&
                    nome !== "Nome"
                ) {
                    alunos.push({ matricula, numero, nome, turma });
                }
            });
            atualizarListas();
            document.getElementById('inputImportAlunos').value = '';
            alert('Alunos importados com sucesso!\nAtenção: a planilha deve ter matrícula na primeira coluna, número na segunda, nome completo na terceira e turma na quarta.');
        };
        reader.readAsArrayBuffer(file);
    });

    // Inicializa listas
    atualizarListas();
    </script>
</body>
</html>